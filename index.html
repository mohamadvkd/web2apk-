<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ­ÙˆÙŠÙ„ ÙˆÙŠØ¨ Ø¥Ù„Ù‰ APK - Ù…Ø¨Ø³Ø·</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; }
        .container { max-width: 800px; margin: auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
        h1 { color: #2d3436; margin-bottom: 25px; text-align: center; font-size: 28px; border-bottom: 3px solid #4361ee; padding-bottom: 15px; }
        .upload-zone { border: 3px dashed #4361ee; padding: 50px 30px; text-align: center; border-radius: 12px; margin: 25px 0; background: #f8f9ff; cursor: pointer; }
        .upload-zone:hover { background: #edf0ff; border-color: #3a0ca3; transform: translateY(-2px); }
        .upload-icon { font-size: 60px; color: #4361ee; margin-bottom: 15px; }
        #fileList { margin: 20px 0; min-height: 120px; max-height: 300px; overflow-y: auto; border: 1px solid #e9ecef; border-radius: 8px; padding: 10px; background: #f8f9fa; }
        .file-item { background: white; padding: 12px 15px; margin: 8px 0; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid #4361ee; }
        .file-name { font-weight: bold; color: #2d3436; }
        .file-size { color: #6c757d; font-size: 0.9em; }
        .file-icon { margin-left: 10px; color: #4361ee; }
        button { background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%); color: white; border: none; padding: 18px 30px; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; width: 100%; margin: 20px 0; display: flex; align-items: center; justify-content: center; gap: 10px; }
        button:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(67,97,238,0.3); }
        button:disabled { background: #ccc; cursor: not-allowed; transform: none; box-shadow: none; }
        .status { padding: 15px; margin: 15px 0; border-radius: 8px; display: none; border-right: 5px solid; }
        .success { background: #d4edda; color: #155724; border-color: #28a745; display: block; }
        .error { background: #f8d7da; color: #721c24; border-color: #dc3545; display: block; }
        .processing { background: #fff3cd; color: #856404; border-color: #ffc107; display: block; }
        #result { background: #e8f4fd; padding: 20px; border-radius: 10px; margin-top: 25px; border-left: 5px solid #17a2b8; }
        #result h3 { color: #17a2b8; margin-bottom: 10px; }
        .file-info { background: white; padding: 15px; border-radius: 8px; margin: 15px 0; }
        .info-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
        .info-row:last-child { border-bottom: none; }
        .download-btn { background: #28a745; margin: 10px 0; }
        .download-btn:hover { background: #218838; }
        @media (max-width: 768px) { .container { padding: 20px; } h1 { font-size: 24px; } .upload-zone { padding: 40px 20px; } button { padding: 15px 25px; font-size: 16px; } }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“± Ù…Ø­ÙˆÙ„ ÙˆÙŠØ¨ Ø¥Ù„Ù‰ APK</h1>
        <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
            <div class="upload-icon">ğŸ“</div>
            <h3>Ø§Ù†Ù‚Ø± Ù„Ø±ÙØ¹ Ù…Ù„ÙØ§Øª Ù…ÙˆÙ‚Ø¹Ùƒ</h3>
            <p>HTML, CSS, JavaScript, Ø§Ù„ØµÙˆØ±</p>
            <p style="margin-top:15px;color:#666;font-size:0.9em;">Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</p>
            <input type="file" id="fileInput" multiple accept=".html,.css,.js,.png,.jpg,.jpeg,.gif,.svg" style="display:none">
        </div>
        <div id="fileList"><p style="color:#666;text-align:center;padding:30px;">ğŸ“‚ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„ÙØ§Øª Ù…Ø±ÙÙˆØ¹Ø©</p></div>
        <button id="buildBtn" onclick="buildAPK()" disabled><span>ğŸ› ï¸ Ø¨Ù†Ø§Ø¡ Ù…Ù„Ù ZIP</span></button>
        <div id="status" class="status"></div>
        <div id="result" style="display:none;">
            <h3>âœ… ØªÙ… Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­!</h3>
            <div class="file-info">
                <div class="info-row"><span>Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù:</span><span><strong>ZIP Ø£Ø±Ø´ÙŠÙ</strong></span></div>
                <div class="info-row"><span>Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù:</span><span><strong id="fileSize">0</strong> Ø¨Ø§ÙŠØª</span></div>
                <div class="info-row"><span>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù„ÙØ§Øª:</span><span><strong id="filesCount">0</strong> Ù…Ù„Ù</span></div>
                <div class="info-row"><span>ÙˆÙ‚Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:</span><span><strong id="buildTime">-</strong></span></div>
            </div>
            <p style="color:#666;margin:15px 0;font-size:0.9em;">ğŸ’¡ <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ù‡Ø°Ø§ Ù…Ù„Ù ZIP ÙŠÙ…ÙƒÙ†Ùƒ ÙØªØ­Ù‡ Ø¹Ù„Ù‰ Ø£ÙŠ Ø¬Ù‡Ø§Ø². Ù„ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ APK Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø§Ø³ØªØ®Ø¯Ù… Apache Cordova.</p>
            <button class="download-btn" onclick="downloadAPK()"><span>ğŸ“¥ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù (ZIP)</span></button>
        </div>
    </div>
    
    <script src="js/main.js"></script>
    <script src="js/apk-template.js"></script>
    <script src="js/zip-builder.js"></script>
    
    <script>
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        let uploadedFiles = [];
        let generatedZip = null;
        const appSettings = { appName: 'ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆÙŠØ¨', packageName: 'com.webbuilder.app', version: '1.0.0' };
        
        // Ø­Ø¯Ø« Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª (Ù…Ø¨Ø³Ø·)
        document.getElementById('fileInput').onchange = function(e) {
            uploadedFiles = Array.from(e.target.files);
            window.uploadedFiles = uploadedFiles;
            updateFileList();
            document.getElementById('buildBtn').disabled = uploadedFiles.length === 0;
            showStatus('success', 'âœ… ØªÙ… Ø±ÙØ¹ ' + uploadedFiles.length + ' Ù…Ù„Ù');
        };
        
        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª
        function updateFileList() {
            const fileList = document.getElementById('fileList');
            if (uploadedFiles.length === 0) {
                fileList.innerHTML = '<p style="color:#666;text-align:center;padding:30px;">ğŸ“‚ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„ÙØ§Øª Ù…Ø±ÙÙˆØ¹Ø©</p>';
                return;
            }
            let html = '';
            uploadedFiles.forEach(file => {
                const size = (file.size > 1024*1024) ? (file.size/(1024*1024)).toFixed(1)+' MB' : (file.size/1024).toFixed(1)+' KB';
                const icon = file.name.endsWith('.html') ? 'ğŸŒ' : file.name.endsWith('.js') ? 'âš¡' : file.name.endsWith('.css') ? 'ğŸ¨' : 'ğŸ“„';
                html += `<div class="file-item"><div><span class="file-icon">${icon}</span><span class="file-name">${file.name}</span></div><span class="file-size">${size}</span></div>`;
            });
            fileList.innerHTML = html;
        }
        
        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        async function buildAPK() {
            if (uploadedFiles.length === 0) { showStatus('error', 'âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ù„ÙØ§Øª Ø£ÙˆÙ„Ø§Ù‹'); return; }
            
            const btn = document.getElementById('buildBtn');
            btn.disabled = true;
            btn.innerHTML = '<span>â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</span>';
            showStatus('processing', 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø¨Ù†Ø§Ø¡ Ù…Ù„Ù ZIP...');
            
            try {
                if (typeof window.createWebZip !== 'function') throw new Error('Ù…ÙƒØªØ¨Ø© ZIP ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©');
                const zipData = await window.createWebZip(uploadedFiles, appSettings);
                generatedZip = zipData;
                
                document.getElementById('result').style.display = 'block';
                document.getElementById('fileSize').textContent = formatBytes(zipData.byteLength);
                document.getElementById('filesCount').textContent = uploadedFiles.length;
                document.getElementById('buildTime').textContent = new Date().toLocaleTimeString('ar-SA');
                showStatus('success', 'âœ… ØªÙ… Ø¨Ù†Ø§Ø¡ Ù…Ù„Ù ZIP Ø¨Ù†Ø¬Ø§Ø­!');
                
            } catch (error) {
                showStatus('error', 'âŒ Ø®Ø·Ø£: ' + error.message);
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<span>ğŸ› ï¸ Ø¨Ù†Ø§Ø¡ Ù…Ù„Ù ZIP</span>';
            }
        }
        
        // ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
        function downloadAPK() {
            if (!generatedZip) { showStatus('error', 'âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ù Ù„ØªÙ†Ø²ÙŠÙ„Ù‡'); return; }
            const blob = new Blob([generatedZip], { type: 'application/zip' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = appSettings.appName + '_' + Date.now() + '.zip';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            showStatus('success', 'ğŸ“¥ Ø¨Ø¯Ø£ Ø§Ù„ØªÙ†Ø²ÙŠÙ„...');
        }
        
        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
        function formatBytes(bytes) {
            if (bytes < 1024) return bytes + ' Ø¨Ø§ÙŠØª';
            if (bytes < 1024*1024) return (bytes/1024).toFixed(1) + ' ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª';
            return (bytes/(1024*1024)).toFixed(1) + ' Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª';
        }
        
        function showStatus(type, message) {
            const el = document.getElementById('status');
            el.className = 'status ' + type;
            el.textContent = message;
            el.style.display = 'block';
        }
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('buildBtn').disabled = true;
            showStatus('success', 'ğŸ‘‹ Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø§Ø±ÙØ¹ Ù…Ù„ÙØ§Øª Ù…ÙˆÙ‚Ø¹Ùƒ Ù„ØªØ¨Ø¯Ø£');
        });
    </script>
</body>
</html>
